<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema"
  xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
  xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC"
  xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI"
  xmlns:flowable="http://flowable.org/bpmn"
  typeLanguage="http://www.w3.org/2001/XMLSchema"
  expressionLanguage="http://www.w3.org/1999/XPath"
  targetNamespace="http://www.flowable.org/processdef">
  
<process id="marketingEmailProcess" name="marketingEmailProcess" isExecutable="true">
	<subProcess id="marketingEmailsubprocessFlowable" name="Marketing Email Sub Process">
	  <startEvent id="startevent1" name="Start"></startEvent>
      <sequenceFlow id="flow1" sourceRef="startevent1" targetRef="inactiveLeadEmailServiceTask"></sequenceFlow>
      <serviceTask id="inactiveLeadEmailServiceTask" name="Introduction" flowable:delegateExpression="${marketingEmailServiceTask}"></serviceTask>
      <sequenceFlow id="flow56" sourceRef="inactiveLeadEmailServiceTask" targetRef="firstEmailTimer"></sequenceFlow>
      <serviceTask id="servicetask1" name="Lead Status Check" flowable:delegateExpression="${leadStatusCheckServiceTask}"></serviceTask>
      <sequenceFlow id="flow22" sourceRef="servicetask1" targetRef="exclusivegateway1"></sequenceFlow>
      <serviceTask id="servicetask2" name="Start your search(Day 1)" flowable:delegateExpression="${marketingEmailServiceTask}"></serviceTask>
      <sequenceFlow id="flow6" sourceRef="servicetask2" targetRef="secondEmailTimer"></sequenceFlow>
      <serviceTask id="servicetask3" name="Lead Status Check" flowable:delegateExpression="${leadStatusCheckServiceTask}"></serviceTask>
      <sequenceFlow id="flow25" sourceRef="servicetask3" targetRef="exclusivegateway2"></sequenceFlow>
      <intermediateCatchEvent id="firstEmailTimer" name="TimerCatchEvent">
        <timerEventDefinition>
          <timeDate>${startYourSearchStartDateTime}</timeDate>
        </timerEventDefinition>
      </intermediateCatchEvent>
      <sequenceFlow id="flow57" sourceRef="firstEmailTimer" targetRef="servicetask1"></sequenceFlow>
      <intermediateCatchEvent id="secondEmailTimer" name="TimerCatchEvent">
        <timerEventDefinition>
          <timeDuration>${rebateEmailDuration}</timeDuration>
        </timerEventDefinition>
      </intermediateCatchEvent>
      <sequenceFlow id="flow39" sourceRef="secondEmailTimer" targetRef="servicetask3"></sequenceFlow>
      <intermediateCatchEvent id="thirdEmailTimer" name="TimerCatchEvent">
        <timerEventDefinition>
          <timeDuration>${scheduleTourEmailDuration}</timeDuration>
        </timerEventDefinition>
      </intermediateCatchEvent>
      <sequenceFlow id="flow40" sourceRef="thirdEmailTimer" targetRef="servicetask5"></sequenceFlow>
      <intermediateCatchEvent id="fourthEmailTimer" name="TimerCatchEvent">
        <timerEventDefinition>
          <timeDuration>${makeYourAgentEmailDuration}</timeDuration>
        </timerEventDefinition>
      </intermediateCatchEvent>
      <sequenceFlow id="flow42" sourceRef="fourthEmailTimer" targetRef="servicetask7"></sequenceFlow>
      <intermediateCatchEvent id="fifthEmailTimer" name="TimerCatchEvent">
        <timerEventDefinition>
          <timeDuration>${finalOutreachEmailDuration}</timeDuration>
        </timerEventDefinition>
      </intermediateCatchEvent>
      <sequenceFlow id="flow68" sourceRef="fifthEmailTimer" targetRef="servicetask9"></sequenceFlow>
      <serviceTask id="servicetask4" name="Rebate(Day 2)" flowable:delegateExpression="${marketingEmailServiceTask}"></serviceTask>
      <sequenceFlow id="flow41" sourceRef="servicetask4" targetRef="thirdEmailTimer"></sequenceFlow>
      <serviceTask id="servicetask5" name="Lead Status Check" flowable:delegateExpression="${leadStatusCheckServiceTask}"></serviceTask>
      <sequenceFlow id="flow28" sourceRef="servicetask5" targetRef="exclusivegateway3"></sequenceFlow>
      <serviceTask id="servicetask6" name="Schedule Tour(Day 6)" flowable:delegateExpression="${marketingEmailServiceTask}"></serviceTask>
      <sequenceFlow id="flow12" sourceRef="servicetask6" targetRef="fourthEmailTimer"></sequenceFlow>
      <serviceTask id="servicetask7" name="Lead Status Check" flowable:delegateExpression="${leadStatusCheckServiceTask}"></serviceTask>
      <sequenceFlow id="flow64" sourceRef="servicetask7" targetRef="exclusivegateway4"></sequenceFlow>
      <endEvent id="endevent1" name="End"></endEvent>
      <exclusiveGateway id="exclusivegateway1" name="Exclusive Gateway"></exclusiveGateway>
      <sequenceFlow id="flow23" sourceRef="exclusivegateway1" targetRef="servicetask2">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${status==true}]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="flow24" sourceRef="exclusivegateway1" targetRef="marketingEmailLogCleanupServiceTask">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${status==false}]]></conditionExpression>
      </sequenceFlow>
      <exclusiveGateway id="exclusivegateway2" name="Exclusive Gateway"></exclusiveGateway>
      <sequenceFlow id="flow26" sourceRef="exclusivegateway2" targetRef="servicetask4">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${status==true}]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="flow27" sourceRef="exclusivegateway2" targetRef="marketingEmailLogCleanupServiceTask">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${status==false}]]></conditionExpression>
      </sequenceFlow>
      <exclusiveGateway id="exclusivegateway3" name="Exclusive Gateway"></exclusiveGateway>
      <sequenceFlow id="flow62" sourceRef="exclusivegateway3" targetRef="marketingEmailLogCleanupServiceTask">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${status==false}]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="flow63" sourceRef="exclusivegateway3" targetRef="servicetask6">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${status==true}]]></conditionExpression>
      </sequenceFlow>
      <exclusiveGateway id="exclusivegateway4" name="Exclusive Gateway"></exclusiveGateway>
      <sequenceFlow id="flow65" sourceRef="exclusivegateway4" targetRef="marketingEmailLogCleanupServiceTask">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${status==false}]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="flow66" sourceRef="exclusivegateway4" targetRef="servicetask8">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${status==true}]]></conditionExpression>
      </sequenceFlow>
      <serviceTask id="servicetask8" name="Meet your owners.com agent(Day 9)" flowable:delegateExpression="${marketingEmailServiceTask}"></serviceTask>
      <sequenceFlow id="flow67" sourceRef="servicetask8" targetRef="fifthEmailTimer"></sequenceFlow>
      <serviceTask id="servicetask9" name="Lead Status Check" flowable:delegateExpression="${leadStatusCheckServiceTask}"></serviceTask>
      <sequenceFlow id="flow69" sourceRef="servicetask9" targetRef="exclusivegateway5"></sequenceFlow>
      <exclusiveGateway id="exclusivegateway5" name="Exclusive Gateway"></exclusiveGateway>
      <sequenceFlow id="flow70" sourceRef="exclusivegateway5" targetRef="marketingEmailLogCleanupServiceTask">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${status==false}]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="flow71" sourceRef="exclusivegateway5" targetRef="servicetask10">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${status==true}]]></conditionExpression>
      </sequenceFlow>
      <serviceTask id="servicetask10" name="Final outreach - here when you need us(Day 13)" flowable:delegateExpression="${marketingEmailServiceTask}"></serviceTask>
      <sequenceFlow id="flow72" sourceRef="servicetask10" targetRef="marketingEmailLogCleanupServiceTask"></sequenceFlow>
      <serviceTask id="marketingEmailLogCleanupServiceTask" name="Marketing Email Closure" flowable:delegateExpression="${marketingEmailClosureServiceTask}"></serviceTask>
      <sequenceFlow id="flow75" sourceRef="marketingEmailLogCleanupServiceTask" targetRef="endevent1"></sequenceFlow>
	</subProcess>
	<startEvent id="startevent2" name="Start"></startEvent>
    <sequenceFlow id="flow73" sourceRef="startevent2" targetRef="marketingEmailsubprocessFlowable"></sequenceFlow>
    <boundaryEvent id="boundaryerror1" name="marketingEmailBoundaryError" attachedToRef="marketingEmailsubprocessFlowable">
      <errorEventDefinition errorRef="lead.followup.email.error"></errorEventDefinition>
    </boundaryEvent>
    <endEvent id="endevent2" name="End"></endEvent>
    <serviceTask id="marketingEmailErrorHandlerServiceTask" name="Marketing email error task" flowable:delegateExpression="${marketingEmailErrorHandlerServiceTask}"></serviceTask>
    <sequenceFlow id="flow76" sourceRef="boundaryerror1" targetRef="marketingEmailErrorHandlerServiceTask"></sequenceFlow>
    <sequenceFlow id="flow77" sourceRef="marketingEmailErrorHandlerServiceTask" targetRef="endevent2"></sequenceFlow>
	<dataObject id="EMAIL_TEMPLATE" name="EMAIL_TEMPLATE" itemSubjectRef="xsd:string">
      <extensionElements>
        <flowable:value>MARKETING_EMAIL_INTRODUCTION</flowable:value>
      </extensionElements>
    </dataObject>
</process>
</definitions>